# Система автоматизации складского предприятия
## Аннотация
Данное приложение является учебным и разрабатывается в рамках курса Software Architect 2019-11 образовательной компании [OTUS](https://otus.ru/)
## Краткое описание
Система управления складским предприятием. Предприятие оказывает услуги по хранению товаров клиентов. Приёмка и отгрузка товаров клиентам осуществляется по заявкам клиентов, пользующихся услугами складского предприятия. Клиенты складского предприятия подают заявку на приёмку/получения товаров в виде списка единиц хранения (SKU). Сотрудник складского предприятия подтверждает принятие заявки, с указанием даты и времени приёмки/отгрузки, либо отклоняет, с указанием причины. Заявка клиента представляет собой список мест хранения (коробка, поддон и пр.) для каждого из которых определён перечень SKU (с количеством). Идентификация SKU осуществляется по штрих-коду. В системе должна быть описана структура мест хранения (адресное хранение). Сотрудники предприятия используют программные средства поддержки адресного хранения для подбора и размещения товаров клиентов. Любые перемещения товаров в рамках складского предприятия осуществляются только на основе данных предоставляемых системой - что и где (SKU и в какой ячейке) взять или положить для выполнения заявок клиентов. Дополнительно, должны быть разработаны следующие отчёты: отчёт об инвентаризации как для клиентов, так и для сотрудников предприятия; отчёт о заполнении складских мощностей; отчёт о движении SKU за период. Предполагается использовать следующие технологии: Microsoft SQL Server, Node.js, SPA (React или Angular).
## Термины
### Единица хранения
Единица хранения (SKU – stock keeping unit) – это минимальная значимая единица товара, единичная упаковка товара. Единица хранения не может включать в себя другие единицы хранения, т.е. является атомарной. Каждая единица хранения идентифицируется по уникальному штрих-коду (соответствует артикулу товара по производителю, не серийный номер, а именно артикул) на своей упаковке. Для каждой единицы хранения указывается название (артикул) – для визуальной идентификации, вес, объём и площадь (стороны) основания.
### Поддон
Поддон (pallet) – совокупность SKU, физически размещённых на поддоне. Сущность поддон используется при приёмке и отгрузке товаров по заявке клиент. При приёмке товаров, в заявке, указывается номер поддона (сквозной уникальный номер для данного контрагента), состав поддона – список SKU и их (SKU) количество. Допускается приёмка отдельных SKU, без паллетирования.
### Структурная единица описания хранилища
Структурная единица описания хранилища – узел в иерархическом описании структуры хранилища. Структура хранилища представляет собой дерево. Например, в здании находится помещение, в помещении размещены стеллажи, у стеллажей имеются полки, на полках размещены ячейки. Каждая структурная единица описывается уникальным идентификатором, именем, например, стеллаж А, путём к узлу структурной единицы в рамках дерева хранилища, например, для единицы «Помещение А\Стеллаж С1\Ячейка Я22» - путь - «А\С1\Я22». Путь структурной единицы хранилища уникален (на уровне базы данных). Каждая структурная единица имеет соответствующий тип: здание, помещение, комната, шкаф, стеллаж, полка, ячейка. Для каждого типа определён атрибут Capacity Range, используемый процедурой валидации при формировании описания структуры хранилища (в ячейку нельзя поместить стеллаж и т.д.). Данный атрибут – число, в элемент с большим числом нельзя вставить элемент с меньшим числом.
### Состояние хранилища
Состояние хранилища (единицы хранилища) – запись содержащая идентификатор единицы хранилища и SKU, находящейся в данной единице хранилища, с указанием количества. SKU не обязательно хранятся в структурных единицах хранилища являющихся листьями дерева хранилища. Данное поведение определяется настройками приложения – для всех узлов или персональными настройками узлов. Выбор стратегии для реализации требует дополнительного исследования.

## Модели данных
### Единица хранения (SKU – stock keeping unit)
    SKU: {
        id: string,
        barCode: string,
        name: string,
        weight: number,
        volume: number,
        baseX: number,
        baseY: number 
    }

### Поддон
    PAL: {
        PalleteNo: string,
        SKUList: [ SKU … ]
    }

### Структурная единица описания хранилища
    storageNodeType: { // здание, помещение, комната, шкаф, стеллаж, полка, ячейка
        typeId: string,
        typeName: string,
        capacityRange: number
    }

    storageNode: {
        id: string,
        type: StorageNodeType,
        path: string, // Уникален
        name: string,
        nodes: [ storageNode … ],
        isStorage: boolean // storage not only is leaf
    }

### Элемент описания состояния хранилища
    storageItemState: {
        node: storageNode,
        sku: SKU,
        quantity: number
    }

### Состояние хранилища (единицы хранилища)
    storageNodeState: {
        state: [ storageItemState … ]
    }

## Описание API 
### Заявки на обслуживание
#### Заявка на приём товаров
/warehouse/request/acceptance
Доступ: Клиент, Сотрудник
Метод: POST
Данные:

    {
	    clientId: string,
	    dueDate: datetime,
	    SKUList: [ SKU … ],
        PALList: [ PAL … ]
    }

Ответ:

    { 
        requestId: string
    }

#### Заявка на отгрузку товаров
/warehouse/request/shipment
Доступ: Клиент, Сотрудник
Метод: POST
Данные:

    {
	    clientId: string,
	    dueDate: datetime,
	    SKUList: [ SKU … ],
        PALList: [ PAL … ]
    }

Ответ:

    { 
        requestId: string
    }

#### Состояние заявки
/warehouse/request/id:/status
Доступ: Клиент, Сотрудник
Метод: GET
Ответ:

    {
	    requestId: string,
	    status: string,
	    reason: string
    }

#### Приём заявки в работу
/warehouse/request/id:/accept
Доступ: Сотрудник
Метод: POST
Ответ:

    {
	    status: string,
	    reason: string
    }

#### Отказ в обслуживании заявки
/warehouse/request/id:/reject
Доступ: Сотрудник
Метод: POST
Ответ:

    {
	    status: string,
	    reason: string
    }

#### Выполнение заявки
/warehouse/request/id:/complete
Доступ: Сотрудник
Метод: POST
Ответ:

    {
	    status: string,
	    reason: string
    }

### Структура хранилища
#### Запрос структуры хранилища
/warehouse/structure?storageNodePath=
Доступ: только сотрудник
Метод: GET
Ответ:

    {
        nodes: [ storageNode … ]
    }

#### Запрос свободных мест хранилища
/warehouse/freestorage?storageNodePath
Доступ: только сотрудник
Метод: GET
Ответ:

    {
        nodes: [ storageNode … ]
    }

#### Запрос на добавления элемента хранилища
/warehouse/structure/addstorage
Доступ: только сотрудник
Метод: POST
Данные:

    {
        parentStorageNodePath: string,
        newStorageType: string,
        newStogareName: string
    }

Ответ:

    {
        status: string,
        reason: string
    }

#### Запрос на удаление элемента хранилища
/warehouse/structure/removestorage?storageNodePath=
Доступ: только сотрудник
Метод: DELETE
Ответ:

    {
        status: string,
        reason: string
    }

### Инвентаризация и поиск SKU
#### Инвентаризация предприятия для клиента
/warehouse/inventory&clientid= &type=
Доступ: Клиент, Сотрудник
Метод: GET
Ответ:
Тип краткий

    {
	    type: string,
	    inventory: [
		    { SKU: SKU,  quantity: number } …
	    ]
    }

Тип расширенный 

    {
	    type: string,
	    inventory: [
		    { SKU: SKU, place: storageNode, quantity: number} …
	    ]
    }

#### Поиск SKU
/warehouse/searchsku&clientid= &sku=
Доступ: Клиент, Сотрудник
Метод: GET
Ответ:

    {
	    SKU: SKU,
	    place: storageNode,
	    quantity: number
    }

#### Состояние хранилища
/warehouse/state&storagepath=
Доступ: Сотрудник
Метод: GET
Ответ:

    {
	    SKU: SKU,
	    place: storageNode,
	    quantity: number
    }

### Мини CRM
#### Регистрация клиента
/warehouse/clients/add
Доступ: Сотрудник
Метод: POST
Данные:

    {
	    name: string,
	    email: string,
	    phone: string,
	    contactName: string
    }

Ответ:

    {
	    clientId: string
	    status: string,
	    reason: string
    }

#### Обновление данных о клиенте
/warehouse/clients/id:/update
Доступ: Сотрудник
Метод: PUT
Данные:

    {
	    name: string,
	    email: string,
	    phone: string,
	    contactName: string
    }

Ответ:

    {
	    status: string,
	    reason: string
    }

#### Получение данных о клиенте
/warehouse/clients/id:
Доступ: Сотрудник
Метод: GET
Ответ:

    {
        clientid: string,
	    name: string,
	    email: string,
	    phone: string,
	    contactName: string
    }



